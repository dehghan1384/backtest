# -----------------------------------------------------
# ๐ BacktestPro - ุณุณุชู ุณุงุฏู ุชุณุช ุงุณุชุฑุงุชฺ ูุนุงููุงุช
# -----------------------------------------------------

import streamlit as st

st.set_page_config(page_title="BacktestPro", layout="wide")
st.title("๐ BacktestPro - ุณุณุชู ุณุงุฏู ุชุณุช ุงุณุชุฑุงุชฺ ูุนุงููุงุช")

st.markdown("ุจุง ุงูุชุฎุงุจ ฺฏุฒููโูุงุ ุงุณุชุฑุงุชฺ ุฎูุฏ ุฑุง ุจุฏูู ูุงุฒ ุจู ฺฉุฏููุณ ุชุณุช ฺฉูุฏ.")

# ุงูุชุฎุงุจ ููุงุฏ
symbol = st.selectbox("ุงูุชุฎุงุจ ููุงุฏ ุงุฑุฒ:", ["BTC/USDT", "ETH/USDT", "BNB/USDT"])

# ุงูุชุฎุงุจ ุชุงูโูุฑู
timeframe = st.selectbox("ุงูุชุฎุงุจ ุชุงูโูุฑู:", ["1h", "4h", "1d"])

# ุงูุชุฎุงุจ ุดุฑุท ูุฑูุฏ ู ุฎุฑูุฌ ุงุฒ ูุณุช ุขูุงุฏู
entry_condition = st.selectbox("ุดุฑุท ูุฑูุฏ:", [
    "EMA(9) > EMA(21)",
    "SMA(50) > SMA(200)",
    "RSI < 30"
])

exit_condition = st.selectbox("ุดุฑุท ุฎุฑูุฌ:", [
    "EMA(9) < EMA(21)",
    "SMA(50) < SMA(200)",
    "RSI > 70"
])

# ุณุฑูุงู ุงููู ู ุญุฌู ูุนุงููู
initial_balance = st.number_input("ุณุฑูุงู ุงููู (USDT):", min_value=10.0, value=1000.0)
trade_size = st.number_input("ุญุฌู ูุฑ ูุนุงููู (% ุงุฒ ุณุฑูุงู):", min_value=1.0, max_value=100.0, value=10.0)

#...............................................


import pandas as pd

st.header("๐ ุจุงุฑฺฏุฐุงุฑ ุฏุงุฏูโูุง ุจุงุฒุงุฑ")

# ุขูพููุฏ ูุงู CSV ุชูุณุท ฺฉุงุฑุจุฑ
uploaded_file = st.file_uploader("ูุงู CSV ุฏุชุง ุจุงุฒุงุฑ ุฑุง ุขูพููุฏ ฺฉูุฏ", type=["csv"])

if uploaded_file:
    df = pd.read_csv(uploaded_file)
    
    # ูพุดโููุงุด ุฏุงุฏูโูุง
    st.subheader("ูพุดโููุงุด ุฏุชุง:")
    st.dataframe(df.head())

    # ูพุงฺฉโุณุงุฒ ุฏุชุง
    df.dropna(inplace=True)

    # ุชุจุฏู ุณุชูู ุชุงุฑุฎ ุจู datetime (ุงฺฏุฑ ูุฌูุฏ ุฏุงุฑู)
    if "date" in df.columns or "Date" in df.columns:
        date_col = "date" if "date" in df.columns else "Date"
        df[date_col] = pd.to_datetime(df[date_col])
        df.set_index(date_col, inplace=True)
        df = df.sort_index()

    st.success("โ ุฏุชุง ุจุง ููููุช ุขูุงุฏูโุณุงุฒ ุดุฏ.")


# [ูุฑุญูู 3] ุชุจุฏู ุดุฑุทโูุง ฺฉุงุฑุจุฑ ุจู ูุฑูุช ุฏุงุฎู
# - ุชุฌุฒูโ ูุชู ุดุฑุทโูุง (ูุซูุงู ุชุดุฎุต EMA(9))
# - ุฐุฎุฑู ุดุฑุงุท ุฏุฑ ฺฉ ุณุงุฎุชุงุฑ ุงุณุชุงูุฏุงุฑุฏ (ูุซู dict ุง JSON)

# [ูุฑุญูู 4] ุงุฌุฑุง ุงูฺฏูุฑุชู ุจฺฉโุชุณุช
# - ุญููู ุฑู ุฏุชุง ุชุงุฑุฎ ุจุฑุง ุจุฑุฑุณ ุดุฑุท ูุฑูุฏ
# - ุฏุฑ ุตูุฑุช ูุนุงู ุดุฏูุ ุซุจุช ฺฉ ูุนุงููู
# - ุจุฑุฑุณ ุดุฑุท ุฎุฑูุฌ ู ุจุณุชู ูุนุงููู
# - ุซุจุช ุณูุฏ/ุถุฑุฑ ูุฑ ูุนุงููู ู ูุถุนุช ุญุณุงุจ

# [ูุฑุญูู 5] ูุญุงุณุจูโ ุขูุงุฑ ููุง
# - ุฏุฑุตุฏ ูุนุงููุงุช ุจุฑุฏ (Win Rate)
# - ูุงูฺฏู ุณูุฏ/ุถุฑุฑ (Average Return)
# - ุจุดุชุฑู ุงูุช ุณุฑูุงู (Maximum Drawdown)
# - ุชุนุฏุงุฏ ูุนุงููุงุช ูููู ู ูุงูููู

# [ูุฑุญูู 6] ููุงุด ุฎุฑูุฌโูุง ุจู ฺฉุงุฑุจุฑ
# - ููุงุด ุฌุฏูู ูุชุงุฌ ูุนุงููุงุช
# - ูููุฏุงุฑ Equity Curve ุจุง matplotlib ุง st.pyplot
# - ูพุงูโูุง ูุดุฏุงุฑ ูุซู: ยซุจฺฉโุชุณุช ุชุถูู ุจุฑุง ุณูุฏ ูุณุชยป

# [ูุฑุญูู 7] ุขูุงุฏูโุณุงุฒ ุจุฑุง ุฐุฎุฑู ุง ุฏุงูููุฏ ฺฏุฒุงุฑุด
# - ูุงุจูุช ุฏุงูููุฏ ูุงู ูุชุงุฌ
# - ุฐุฎุฑู ุชูุธูุงุช ูุนู ุจุฑุง ุชุณุชโูุง ุจุนุฏ

# -----------------------------------------------------
# ๐ ูพุงุงู ุฌุฑุงู ฺฉุงุฑ
# -----------------------------------------------------

